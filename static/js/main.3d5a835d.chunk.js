(this.webpackJsonpthird_party=this.webpackJsonpthird_party||[]).push([[0],{143:function(e,t,a){e.exports=a(263)},148:function(e,t,a){},262:function(e,t,a){},263:function(e,t,a){"use strict";a.r(t);var r,n=a(0),i=a.n(n),l=a(14),o=a.n(l),s=(a(148),a(48)),c=a(275),u=a(139),m=a(273),p=a(279),f=a(108),d=a(80),y=a(81),v=a(93),h=a(91),g=r=i.a.createContext(),w=g.Provider,b=(g.Consumer,function(e){Object(v.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).state={dfrsFormData:{}},e.f_setDfrsFormData=function(t){e.setState({dfrsFormData:t})},e}return Object(y.a)(a,[{key:"render",value:function(){return i.a.createElement(w,{value:Object(f.a)(Object(f.a)({},this.state),{},{f_setDfrsFormData:this.f_setDfrsFormData})},this.props.children)}}]),a}(i.a.Component)),E=a(271),P=a(269),D=a(266),M={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},k=function(e){return i.a.createElement(E.a,Object.assign({name:"deforestation_control"},M,{onFinish:e.onFinish}),i.a.createElement(E.a.Item,{name:"range-picker",label:"Time Range"},i.a.createElement(P.a.RangePicker,{format:"YYYY/MM/DD"})),i.a.createElement(E.a.Item,{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},i.a.createElement(D.a,null,i.a.createElement(u.a,{type:"primary",htmlType:"submit",id:"button-form-deforestation"},"Submit"),i.a.createElement(u.a,{type:"primary",htmlType:"submit",id:"button-form-deforestation"},"Clear"))))},S=function(e){var t=Object(n.useState)(!1),a=Object(s.a)(t,2),r=a[0],l=a[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"button-notif"},i.a.createElement(c.a,{count:e.count},i.a.createElement(u.a,{type:"primary",shape:"circle",size:"large",id:"buttonNotif",onClick:e.onClick},i.a.createElement(p.a,null)))),i.a.createElement(m.a,{title:"Deforestation",placement:"right",closable:!0,onClose:function(){l(!1)},visible:r,width:500}))},O=a(274),C=a(267),_=a(280),j=a(281),I=(O.a.SubMenu,function(e){var t=Object(n.useState)(!0),a=Object(s.a)(t,2),r=a[0];a[1];return i.a.createElement(C.a.Sider,{collapsed:r},i.a.createElement("div",{className:"logo"}),i.a.createElement(O.a,{theme:"dark",defaultSelectedKeys:["1"],mode:"inline"},i.a.createElement(O.a.Item,{key:"1",icon:i.a.createElement(_.a,null)},"Maps"),i.a.createElement(O.a.Item,{key:"9",icon:i.a.createElement(j.a,null)})))}),R=a(135),F=a(276),L=a(268),T=a(272),x=a(277),A=a(278),N=a(68),G=a(270),Y=a(42),z=a.n(Y),B=function(e){return i.a.createElement(G.a,{type:"inner",title:"Deforestation ".concat(e.index),extra:i.a.createElement(u.a,{type:"dashed",onClick:e.zoomTo},"Zoom to")},i.a.createElement(F.a,{size:"small",layout:"vertical"},i.a.createElement(F.a.Item,{label:"Latitude"},e.lat),i.a.createElement(F.a.Item,{label:"Longitude"},e.lon),i.a.createElement(F.a.Item,{label:"Start Date"},z()(new Date(e.startdate)).format("yyyy/MM/DD")),i.a.createElement(F.a.Item,{label:"End Date"},z()(new Date(e.enddate)).format("yyyy/MM/DD")),i.a.createElement(F.a.Item,{label:"Peatland"},e.peatland," ha"),i.a.createElement(F.a.Item,{label:"Mangrove"},e.mangrove," ha"),i.a.createElement(F.a.Item,{label:"Other"},e.other," ha"),i.a.createElement(F.a.Item,{label:"Total"},e.total," ha")))},V="http://10.7.12.21:8000/service/WGService.asmx/",W=function(e){Object(v.a)(a,e);var t=Object(h.a)(a);function a(e,r){var n;return Object(d.a)(this,a),(n=t.call(this,e,r)).f_showDrawer=function(e){n.setState({isDrawerShow:e})},n.f_dfrsFormOnFinish=function(e){var t=e["range-picker"][0].format("YYYY-MM-DD"),a=e["range-picker"][1].format("YYYY-MM-DD"),r=n.layerDeforestationPoint.createQuery();r.where="start_date >= '".concat(t,"' and end_date <= '").concat(a,"'"),n.layerDeforestationPoint.queryFeatures(r).then((function(e){return n.setState({dfrsResult:e.features})})),n.layerDeforestationPoint.definitionExpression="start_date >= '".concat(t,"' and end_date <= '").concat(a,"'"),n.layerDeforestationPoint.visible=!0},n.mapRef=i.a.createRef(),n.state={isDrawerShow:!1,dfrsResult:null},n}return Object(y.a)(a,[{key:"componentDidMount",value:function(){var e=this;Object(R.loadModules)(["esri/Map","esri/views/MapView","esri/layers/VectorTileLayer","esri/widgets/BasemapGallery","esri/widgets/Expand","esri/widgets/LayerList","esri/layers/FeatureLayer","esri/layers/GroupLayer","esri/Graphic","esri/layers/GraphicsLayer","esri/widgets/Legend","esri/geometry/geometryEngine","esri/core/watchUtils","esri/widgets/DistanceMeasurement2D","esri/tasks/support/Query"],{css:!0}).then((function(t){var a=Object(s.a)(t,15),r=a[0],l=a[1],c=a[2],m=a[3],p=a[4],f=a[5],d=a[6],y=a[7],v=a[8],h=a[9],g=a[10],w=a[11],b=a[12],E=(a[13],a[14]),P=function(t){for(var a=Object(n.useState)(!1),r=Object(s.a)(a,2),l=r[0],o=r[1],c=t.data,m=[],p=0,f=Object.keys(c);p<f.length;p++){var d=f[p];m.push(i.a.createElement(F.a.Item,{label:d,key:d},c[d]))}var y=function(t,a,r,n){var i;"Refinery"===a?(i="".concat(V,"_GetPOMSupplier_?refinery=").concat(t),e.layerPom.visible=!0):"POM"===a&&(i="".concat(V,"_GetRefinery_?pom=").concat(t),e.layerRefinery.visible=!0),fetch(i).then((function(e){return e.json()})).then((function(t){var a={type:"simple-line",color:[226,119,40],width:2};t.map((function(t){var i={type:"polyline",paths:[[r,n],[parseFloat(t.X_Coor),parseFloat(t.Y_Coor)]]},l=new v({geometry:i,symbol:a});e.view.graphics.add(l)}))})).then((function(){return o(!0)})).catch((function(e){return console.log("error",e)}))},h=function(){e.view.graphics.removeAll(),e.layerRefinery.visible=!1,o(!1)};return i.a.createElement(i.a.Fragment,null,i.a.createElement(F.a,{title:t.title,style:{fontSize:"12px"},bordered:!0,column:1,size:"small"},m),i.a.createElement(L.a,null),function(){switch(t.title){case"POM":return l?i.a.createElement(u.a,{type:"primary",onClick:h,danger:!0},"Clear"):i.a.createElement(u.a,{type:"primary",onClick:function(){return y(c.pomid,t.title,t.position.longitude,t.position.latitude)}},"Trace");case"Refinery":return 1==l?i.a.createElement(u.a,{type:"primary",onClick:h,danger:!0},"Clear"):i.a.createElement(u.a,{type:"primary",onClick:function(){return y(c.rfid,t.title,t.position.longitude,t.position.latitude)}},"Trace")}}())},D=function(t){var a=Object(n.useState)([]),r=Object(s.a)(a,2),l=r[0],o=r[1],c=Object(n.useState)([]),m=Object(s.a)(c,2),p=m[0],f=m[1],d=[{label:"POM",value:e.layerPom},{label:"Reffinery",value:e.layerRefinery},{label:"Concession Area",value:e.layerPlantationArea}];return i.a.createElement(i.a.Fragment,null,i.a.createElement(L.a,null),i.a.createElement("h4",null,"Buffer Radius in Kilometers"),i.a.createElement("div",{style:{width:"80%"}},i.a.createElement(T.a,{defaultValue:0,tooltipVisible:!0,tooltipPlacement:"bottom",onChange:t.onSliderChange})),i.a.createElement(L.a,null),i.a.createElement("h4",null,"Choose layer to include in analysis"),i.a.createElement(x.a.Group,{options:d,onChange:function(e){d.map((function(t){e.includes(t.value)?t.value.visible=!0:t.value.visible=!1}))}}),i.a.createElement(L.a,null),l.length>0?i.a.createElement("h2",null,"POM"):null,l.map((function(e){return i.a.createElement("li",{key:e},e)})),p.length>0?i.a.createElement(i.a.Fragment,null,i.a.createElement("br",null),i.a.createElement("h2",null,"Concession")):null,p.map((function(e){return i.a.createElement("li",{key:e},e)})),i.a.createElement(L.a,null),i.a.createElement(u.a,{type:"primary",onClick:function(){console.log(e.bufferLayer.graphics.getItemAt(0));var t=void 0!==e.bufferLayer.graphics.getItemAt(0)&&e.bufferLayer.graphics.getItemAt(0).geometry;if(t){var a=new E;a.geometry=t,a.spatialRelationship="intersects",e.layerPom.queryFeatures(a).then((function(e){var t=e.features.map((function(e){return e.attributes.PomName}));o(t)})),e.layerPlantationArea.queryFeatures(a).then((function(e){console.log(e.features);var t=e.features.map((function(e){return e.attributes.Name}));f(t)}))}}},"Analysze"))},M=function(t,a){console.log(t,a);var r=document.createElement("div");if("POM"===a)N.content=r,o.a.render(i.a.createElement(P,{data:t.graphic.attributes,title:a,position:{latitude:t.graphic.geometry.latitude,longitude:t.graphic.geometry.longitude}}),r);else if("Deforestation Point"===a){Y.content=r;o.a.render(i.a.createElement(D,{onSliderChange:function(a){!function(t,a){if(a>0){var r=w.geodesicBuffer(t,a,"kilometers");0===e.bufferLayer.graphics.length?e.bufferLayer.add(new v({geometry:r,symbol:{type:"simple-fill",color:[140,140,222,.5],outline:{color:[0,0,0,.5],width:2}}})):e.bufferLayer.graphics.getItemAt(0).geometry=r}else e.bufferLayer.removeAll()}(t.graphic.geometry,a)}}),r)}return r},k=new r({basemap:"streets-night-vector"});e.view=new l({container:e.mapRef.current,map:k,center:[118,0],zoom:4}),e.view.when((function(){console.log("sukses")}),(function(e){console.log(e)})),e.layerPlantationPoint=new d({url:"https://idjktsvr10.wil.local/arcgis/rest/services/NewGISInteractiveMap/OilPalm_Plantation_TP_Supplier/MapServer/0",title:"Oil Palm Plantation of Third Party Supplier",visible:!1}),e.layerPlantationArea=new d({url:"https://idjktsvr10.wil.local/arcgis/rest/services/NewGISInteractiveMap/Third_Party_Supplier/MapServer/2",title:"Oil Palm Area",visible:!1}),e.layerPkCrushing=new d({url:"https://idjktsvr10.wil.local/arcgis/rest/services/industries_MIL1/MapServer/0",title:"PK Crushing",visible:!1}),e.layerRefinery=new d({url:"https://idjktsvr10.wil.local/arcgis/rest/services/NewGISInteractiveMap/Layer_Refinery_201908_sde/MapServer/0",title:"Refinery",visible:!1,popupEnabled:!0,outFields:["*"]}),e.layerPom=new d({url:"https://idjktsvr10.wil.local/arcgis/rest/services/NewGISInteractiveMap/Third_Party_Supplier/MapServer/1",title:"POM Supplier",visible:!1,popupEnabled:!0,outFields:["pomid","PomName","CompanyNam","PlaceName","Tankcap","Silocap"]}),e.layerDeforestationPoint=new d({url:"https://idjktsvr10.wil.local/arcgis/rest/services/NewGISInteractiveMap/Deforestation/MapServer/0",title:"Deforestation Point",visible:!1,popupEnabled:!0}),k.add(e.layerDeforestationPoint),e.layerDeforestationArea=new d({url:"https://idjktsvr10.wil.local/arcgis/rest/services/NewGISInteractiveMap/Deforestation/MapServer/1",title:"Deforestation Area",visible:!1});new c({url:"https://gisportal.wilmar.co.id/arcgisserver/rest/services/Hosted/Wilmar_Basemap2/VectorTileServer?f=pjson"});e.sketchLayer=new h({listMode:"hide"}),e.bufferLayer=new h({listMode:"hide"}),k.addMany([e.sketchLayer,e.bufferLayer]);var S=new y({title:"Industries"}),O=new y({title:"Plantation"}),C=new y({title:"Deforestation"});S.addMany([e.layerPkCrushing,e.layerRefinery,e.layerPom]),O.addMany([e.layerPlantationArea,e.layerPlantationPoint]),C.addMany([e.layerDeforestationArea,e.layerDeforestationPoint]),k.addMany([O,S,C]);var _=new m({view:e.view}),j=new p({view:e.view,content:_,expandTooltip:"Change Basemap"});e.view.ui.add(j,"top-right");var I=new f({view:e.view}),R=new p({view:e.view,content:I,expandTooltip:"Layer List"});e.view.ui.add(R,"top-right");var A=new g({view:e.view});e.view.ui.add(A,"bottom-right");var N={title:"POM Suplier",content:function(e){return M(e,"POM")}};e.layerPom.popupTemplate=N;var G={title:"Refinery",content:function(e){return M(e,"Refinery")}};e.layerRefinery.popupTemplate=G;var Y={title:"Deforestation Point",content:function(e){return M(e,"Deforestation Point")}};e.layerDeforestationPoint.popupTemplate=Y,b.whenTrue(e.view,"stationary",(function(){e.view.zoom>=10?(console.log(e.view.zoom),e.layerDeforestationArea.visible=!!e.layerDeforestationPoint.visible):e.layerDeforestationArea.visible=!1}))}))}},{key:"componentDidUpdate",value:function(){console.log(this.context)}},{key:"componentWillMount",value:function(){this.view&&(this.view.container=null)}},{key:"render",value:function(){var e,t=this;if(null==this.state.dfrsResult)e=i.a.createElement(A.a,{title:"Please choose date range"});else if(0==this.state.dfrsResult.length)e=i.a.createElement(N.a,null);else{var a=[];this.state.dfrsResult.map((function(e,t){console.log(e),a.push(i.a.createElement(B,{key:t,lat:e.attributes.POINT_X,lon:e.attributes.POINT_Y,startdate:e.attributes.start_date,enddate:e.attributes.end_date,peatland:e.attributes.peatland,mangrove:e.attributes.mangrove,other:e.attributes.other,total:e.attributes.total,index:t+1}))})),e=i.a.createElement(D.a,{direction:"vertical"},a)}return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"webmap",ref:this.mapRef}),i.a.createElement(S,{onClick:function(){return t.f_showDrawer(!0)},count:4}),i.a.createElement(m.a,{title:"Deforestation",placement:"right",closable:!0,onClose:function(){return t.f_showDrawer(!1)},visible:this.state.isDrawerShow,width:500},i.a.createElement(k,{onFinish:this.f_dfrsFormOnFinish}),i.a.createElement(L.a,null),i.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between"}},e)))}}]),a}(i.a.Component);W.contextType=r;var q=W,H=(a(262),C.a.Content);var K=function(){return i.a.createElement(b,null,i.a.createElement(C.a,{style:{minHeight:"100vh"}},i.a.createElement(I,null),i.a.createElement(C.a,{className:"site-layout"},i.a.createElement(H,{style:{margin:"0 0px"}},i.a.createElement("div",{className:"site-layout-background",style:{minHeight:"100vh"}},i.a.createElement(q,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(K,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[143,1,2]]]);
//# sourceMappingURL=main.3d5a835d.chunk.js.map